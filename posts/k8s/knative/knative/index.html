<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>AWS Lambda open source avec Knative</title>
    <meta name="description" content="">
    <meta name="keywords" content='blog, makhal, cyber, SIEM, BUT R&amp;T, serverless, knative, kubernetes'>

    <meta property="og:url" content="https://makhal.fr/posts/k8s/knative/knative/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="AWS Lambda open source avec Knative">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://makhal.fr/images/avatar.jpg">
    <meta property="og:image:secure_url" content="https://makhal.fr/images/avatar.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AWS Lambda open source avec Knative">
    <meta name="twitter:description" content="">
    <meta property="twitter:domain" content="https://makhal.fr/posts/k8s/knative/knative/">
    <meta property="twitter:url" content="https://makhal.fr/posts/k8s/knative/knative/">
    <meta name="twitter:image" content="https://makhal.fr/images/avatar.jpg">

    
    <link rel="canonical" href="https://makhal.fr/posts/k8s/knative/knative/" />

    
    <link rel="stylesheet" type="text/css" href="/css/normalize.min.css" media="print">

    
    <link rel="stylesheet" type="text/css" href="/css/main.min.css">

    
    <link id="dark-theme" rel="stylesheet" href="/css/dark.min.css">

    
    <script src="/js/bundle.min.30b2395f3ff8c77f92f8f803732c95cd644f831ff0f058f07e1314dc79d8f3de.js" integrity="sha256-MLI5Xz/4x3&#43;S&#43;PgDcyyVzWRPgx/w8FjwfhMU3HnY894="></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6QF6WSBEBS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-6QF6WSBEBS');
    </script>
    
    
          <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto&display=swap">
    
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">
        
        
            <div class="avatar">
                <a href="https://makhal.fr/">
                    <img src="https://makhal.fr//images/avatar.jpg" alt="avatar" />
                </a>
            </div>
        

        
        <div class="nav-title">
            <a class="nav-brand" href="https://makhal.fr/">makhal.fr</a>
        </div>

        
        <div class="nav-links">
            
                <div class="nav-link">
                    <a href="https://makhal.fr/posts/"> Posts </a>
                </div>
            
                <div class="nav-link">
                    <a href="https://makhal.fr/tags/"> Tags </a>
                </div>
            
                <div class="nav-link">
                    <a href="https://makhal.fr/pages/about/"> Bio </a>
                </div>
            
                <div class="nav-link">
                    <a href="https://www.youtube.com/@makhalX"><span data-feather='youtube'></span>  </a>
                </div>
            
                <div class="nav-link">
                    <a href="https://www.linkedin.com/in/mohamad-el-akhal-8b8319221/"><span data-feather='linkedin'></span>  </a>
                </div>
            
                <div class="nav-link">
                    <a href="https://github.com/tutanka01"><span data-feather='github'></span>  </a>
                </div>
            

            
            <span class="nav-icons-divider"></span>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">   
                
                    <li class="nav-item">
                        <a href="https://makhal.fr/posts/"> Posts </a>
                    </li>
                
                    <li class="nav-item">
                        <a href="https://makhal.fr/tags/"> Tags </a>
                    </li>
                
                    <li class="nav-item">
                        <a href="https://makhal.fr/pages/about/"> Bio </a>
                    </li>
                
                    <li class="nav-item">
                        <a href="https://www.youtube.com/@makhalX"><span data-feather='youtube'></span>  </a>
                    </li>
                
                    <li class="nav-item">
                        <a href="https://www.linkedin.com/in/mohamad-el-akhal-8b8319221/"><span data-feather='linkedin'></span>  </a>
                    </li>
                
                    <li class="nav-item">
                        <a href="https://github.com/tutanka01"><span data-feather='github'></span>  </a>
                    </li>
                
        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>AWS Lambda open source avec Knative</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            novembre 11, 2025
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://makhal.fr/tags/serverless">serverless</a></li>
        
            <li class="post-tag"><a href="https://makhal.fr/tags/knative">knative</a></li>
        
            <li class="post-tag"><a href="https://makhal.fr/tags/kubernetes">kubernetes</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>Est-ce que vous connaissez AWS Lambda ? Ou même Cloud Run de Google ? Ces <strong>très</strong> fameux services &ldquo;serverless&rdquo; qui permettent de déployer du code ou même des conteneurs sans se soucier de l&rsquo;infrastructure qui existe derrière.</p>
<p>On dirait <strong>quasiment</strong> que c&rsquo;est magique : on envoie notre code, et hop, ça fonctionne. Et le plus beau dans tout ça, c&rsquo;est que notre code ou conteneur est exécuté uniquement lorsqu&rsquo;il y a des <strong>requêtes</strong>. Si jamais il n&rsquo;y a personne qui utilise notre service, je ne paie rien, car rien n&rsquo;est en cours d&rsquo;exécution !!</p>
<p>Si tu me disais cela il y a quelques temps, je te dirais que c&rsquo;est une <strong>œuvre</strong> de sorcellerie. Mais aujourd&rsquo;hui, je sais que c&rsquo;est possible grâce à une technologie incroyable : <strong>Knative</strong>.</p>
<blockquote>
<p>C&rsquo;est même celle qui est utilisée par Google Cloud Run derrière les scènes.</p>
</blockquote>
<h2 id="cest-quoi-le-serverless-">C&rsquo;est quoi le serverless ?</h2>
<p><img src="/images/k8s/knative/CIO.png" alt="alt text"></p>
<p>Selon la définition du CIO Council (Chief Information Officers Council) :</p>
<blockquote>
<p>Serverless computing is an emerging cloud computing model whereby cloud providers manage IT infrastructure and users are charged only for the resources they use.</p>
</blockquote>
<p>En gros, le serverless va nous permettre de déployer des applications sans se soucier de l&rsquo;infrastructure derrière. Pour bien comprendre, il faut savoir ce qu&rsquo;on faisait avant, lorsqu&rsquo;on voulait déployer une application.</p>
<p>Avant le serverless, on louait une machine virtuelle (VM) ou un serveur physique sur un Cloud Provider (AWS, GCP, Azure, etc.). Ensuite, on s&rsquo;occupait de tout : l&rsquo;installation du système d&rsquo;exploitation, la <strong>sécurité</strong>, les mises à jour, le déploiement de l&rsquo;application, la gestion des ressources, etc.</p>
<p>De plus, imaginons : mon application, c&rsquo;est un site web de vente de café. Le matin à 8h, j&rsquo;ai plein de monde qui vient acheter du café, mais à 3h du matin, il n&rsquo;y a personne. Du coup, j&rsquo;ai une machine qui tourne <strong>24/7 pour rien</strong>. Avec des ressources qui sont totalement gaspillées (on revient un peu au monde avant le cloud, en fait).</p>
<p>Avec le serverless, on envoie juste notre code ou notre conteneur, et le Cloud Provider s&rsquo;occupe de tout le reste. Il va s&rsquo;occuper de l&rsquo;infrastructure, de la sécurité, des mises à jour, du déploiement, de la gestion des ressources, etc. Et surtout, il va s&rsquo;occuper de <em>scaler</em> (mettre à l&rsquo;échelle) notre application en fonction de la demande. Si jamais il n&rsquo;y a personne qui utilise notre application, il n&rsquo;y a rien qui tourne, donc on ne paie rien. C&rsquo;est ça la magie du serverless.</p>
<h2 id="knative-cest-quoi-">Knative, c&rsquo;est quoi ?</h2>
<p>Knative est une plateforme open source qui permet de transformer un cluster Kubernetes en une plateforme serverless.</p>
<p>Elle fournit des composants pour faciliter le déploiement, la gestion et le <em>scaling</em> d&rsquo;applications serverless sur Kubernetes.</p>
<p>Knative est composé de deux parties principales :</p>
<ul>
<li>
<p><strong>Knative Serving :</strong> C&rsquo;est la partie qui s&rsquo;occupe du déploiement et de la gestion des applications serverless. Elle permet de déployer des applications en utilisant des conteneurs et elle gère le <em>scaling</em> automatique en fonction de la demande (y compris jusqu&rsquo;à zéro !).</p>
</li>
<li>
<p><strong>Knative Eventing :</strong> C&rsquo;est la partie qui s&rsquo;occupe de la gestion des événements. Elle permet de connecter des sources d&rsquo;événements (comme des files d&rsquo;attente, des bases de données, des webhooks GitHub, etc.) à des applications serverless.</p>
</li>
</ul>
<p>Nous, dans ce post, on va se concentrer sur <strong>Knative Serving</strong>.</p>
<p>Mais du coup, comment ça marche Knative Serving concrètement ?</p>
<p><img src="/images/k8s/knative/knative-schema.png" alt="alt text"></p>
<h3 id="la-chorégraphie-magique-du-scale-to-zero">La chorégraphie magique du &ldquo;Scale-to-Zero&rdquo;</h3>
<p>Toute requête pour votre service (disons <code>mon-site-de-cafe.com</code>) n&rsquo;arrive pas directement sur votre application. Elle est d&rsquo;abord interceptée par l&rsquo;<strong>Ingress</strong> (la &ldquo;porte d&rsquo;entrée&rdquo; de notre cluster, <strong>Kourier</strong> dans mon cas).</p>
<p><strong>Attends, Kourier ? C&rsquo;est quoi ça ?</strong></p>
<p>Dans Kubernetes, l&rsquo;<strong>Ingress</strong> est le composant qui reçoit le trafic extérieur (HTTP/HTTPS) et le redirige vers les bons services à l&rsquo;intérieur du cluster. C&rsquo;est le portier de l&rsquo;immeuble.</p>
<p>Knative, lui, a besoin de <em>contrôler</em> ce portier. Il doit pouvoir lui dire : &ldquo;Attention, le pod &lsquo;Café&rsquo; est éteint. Si un client arrive, garde-le au chaud 2 secondes et préviens-moi !&rdquo;</p>
<p>Pour faire ça, Knative a besoin d&rsquo;un Ingress compatible. Historiquement, c&rsquo;était Istio, une vraie usine à gaz, très lourde. Heureusement, l&rsquo;équipe Knative a créé <strong>Kourier</strong> : un Ingress léger, basé sur Envoy, fait <em>sur mesure</em> pour Knative. Il est parfait pour un &ldquo;home lab&rdquo; ou un cluster K3s comme le mien, car il fait juste le job, et il le fait bien.</p>
<p>Voilà ! Fin de la parenthèse. Donc, la requête arrive chez Kourier. Et c&rsquo;est là que la magie commence&hellip;</p>
<h4 id="1-le-pod-22-et-le-queue-proxy">1. Le &ldquo;Pod 2/2&rdquo; et le <code>queue-proxy</code></h4>
<p>Quand j&rsquo;ai déployé ma première application &ldquo;Hello World&rdquo;, j&rsquo;ai tout de suite remarqué un truc bizarre en faisant <code>kubectl get pods</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>NAME                                      READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>hello-00001-deployment-798c574845-9zp7f   2/2     Running   <span style="color:#ae81ff">0</span>          33s
</span></span></code></pre></div><p>Pourquoi <strong><code>READY 2/2</code></strong> ? J&rsquo;ai juste déployé un &ldquo;Hello World&rdquo; !</p>
<p>Le conteneur n°1, c&rsquo;est bien mon application (un <code>nginx</code> ou un <code>helloworld-go</code>). Mais le n°2, c&rsquo;est un &ldquo;sidecar&rdquo; (un acolyte) injecté automatiquement par Knative : le <strong><code>queue-proxy</code></strong>.</p>
<p>C&rsquo;est un agent secret dont le boulot est crucial : il se place <em>devant</em> mon application (à l&rsquo;intérieur du même pod) et <strong>compte le nombre de requêtes actives</strong> qui la visent.</p>
<h4 id="2-linactivité-et-lautoscaler">2. L&rsquo;inactivité et l&rsquo;<code>Autoscaler</code></h4>
<p>Revenons à notre site de café à 3h du matin. Personne n&rsquo;est là.</p>
<ul>
<li>Le <code>queue-proxy</code> compte : &ldquo;0 requête active&rdquo;.</li>
<li>Il envoie cette métrique à un composant central : l&rsquo;<strong><code>Autoscaler</code></strong> (le grand chef).</li>
<li>L&rsquo;<code>Autoscaler</code> attend un peu (par défaut, 60 secondes). Il voit &ldquo;toujours 0 requête&hellip;&rdquo;.</li>
<li>Au bout du délai, il prend la décision : <strong>&ldquo;Ce service est inutile, on éteint tout !&rdquo;</strong></li>
<li>Hop ! Il modifie l&rsquo;objet <code>Deployment</code> Kubernetes et passe le nombre de <code>replicas</code> de 1 à <strong>0</strong>.</li>
</ul>
<p>Le pod disparaît. C&rsquo;est ça, le <strong>Scale-to-Zero</strong>. Plus de pod, plus de consommation de RAM ou de CPU. Le silence total.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>NAME                                      READY   STATUS        RESTARTS   AGE
</span></span><span style="display:flex;"><span>hello-00001-deployment-798c574845-9zp7f   2/2     Terminating   <span style="color:#ae81ff">0</span>          98s
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ... et puis plus rien</span>
</span></span></code></pre></div><h3 id="le-cold-start-démarrage-à-froid">Le &ldquo;Cold Start&rdquo; (Démarrage à froid)</h3>
<p>OK, mais que se passe-t-il quand le premier client de 8h du matin arrive ? Le pod est mort, le site devrait être en 404, non ?</p>
<p>Eh non ! Knative est trop malin.</p>
<p>Quand l&rsquo;<code>Autoscaler</code> a mis le pod à 0, il a aussi reprogrammé le réseau. Il a dit à la porte d&rsquo;entrée (Kourier) : &ldquo;Si une requête arrive pour <code>mon-site-de-cafe.com</code>, <strong>ne la jette pas !</strong> Envoie-la à l&rsquo;<strong><code>Activator</code></strong>.&rdquo;</p>
<p>L&rsquo;<strong><code>Activator</code></strong> (l&rsquo;activateur), c&rsquo;est la &ldquo;salle d&rsquo;attente&rdquo; de notre restaurant.</p>
<ol>
<li>La requête du client de 8h arrive. Kourier l&rsquo;envoie à l&rsquo;<code>Activator</code>.</li>
<li>L&rsquo;<code>Activator</code> reçoit la requête et la <strong>met en attente</strong>.</li>
<li>En même temps, il crie à l&rsquo;<code>Autoscaler</code> : &ldquo;<strong>AU SECOURS ! J&rsquo;AI UN CLIENT ! IL FAUT UN POD !</strong>&rdquo;</li>
<li>L&rsquo;<code>Autoscaler</code> (qui n&rsquo;est pas paniqué) remet <code>replicas: 1</code> sur le <code>Deployment</code>.</li>
<li>Kubernetes démarre un tout nouveau pod (par exemple, <code>...-z8874</code>).</li>
<li>Dès que le pod est <code>Running 2/2</code> (c&rsquo;est-à-dire que le <code>queue-proxy</code> est prêt), l&rsquo;<code>Activator</code> (qui attendait patiemment) lui transmet la requête.</li>
<li>Mon client voit &ldquo;Hello World !&rdquo; (ou son café).</li>
</ol>
<p>C&rsquo;est ça, le <strong>&ldquo;Cold Start&rdquo;</strong> (ou démarrage à froid). C&rsquo;est ce petit délai de 1 ou 2 secondes pendant lequel le client attend que la machine à café chauffe. C&rsquo;est le &ldquo;prix&rdquo; à payer pour avoir économisé des ressources toute la nuit.</p>
<p>Dans ma démo, c&rsquo;est spectaculaire :</p>
<ul>
<li>Je fais un <code>curl</code>, le terminal attend&hellip;</li>
<li>Dans <code>kubectl get pods -w</code>, je vois le nouveau pod passer de <code>Pending</code> à <code>Running</code>&hellip;</li>
<li>&hellip;et <strong>seulement là</strong>, mon <code>curl</code> reçoit enfin la réponse !</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Je lance le curl, il attend...</span>
</span></span><span style="display:flex;"><span>$ curl http://hello.default.192.168.100.135.sslip.io
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Pendant ce temps, dans un autre terminal :</span>
</span></span><span style="display:flex;"><span>$ kubectl get pods -w
</span></span><span style="display:flex;"><span>NAME                                      READY   STATUS              RESTARTS   AGE
</span></span><span style="display:flex;"><span>hello-00001-deployment-798c574845-z8874   0/2     Pending             <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>hello-00001-deployment-798c574845-z8874   0/2     ContainerCreating   <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>hello-00001-deployment-798c574845-z8874   2/2     Running             <span style="color:#ae81ff">0</span>          4s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Mon curl reçoit ENFIN la réponse :</span>
</span></span><span style="display:flex;"><span>Hello Blog Knative sur K3s!
</span></span></code></pre></div><p>Une fois que le pod est chaud, toutes les requêtes suivantes sont instantanées, car elles vont directement au pod, en contournant l&rsquo;Activator.</p>
<h2 id="notre-propre-cloud-run-en-10-minutes">Notre propre Cloud Run en 10 minutes</h2>
<p>OK, la théorie c&rsquo;est bien beau, mais comment on fait ça en vrai ?</p>
<p>Vous allez voir, c&rsquo;est presque magique tellement c&rsquo;est simple. J&rsquo;ai fait ça sur un cluster K3s (la version légère de Kubernetes, parfaite pour les labs) avec les versions <code>v1.20.0</code> de Knative.</p>
<h3 id="étape-1--installer-k3s-sans-traefik-">Étape 1 : Installer K3s&hellip; sans Traefik !</h3>
<p>C&rsquo;est <strong>L&rsquo;ÉTAPE LA PLUS IMPORTANTE</strong>. K3s est génial et vient avec l&rsquo;ingress Traefik pré-installé. Sauf que, comme on l&rsquo;a vu, Knative a besoin de son <em>propre</em> ingress (Kourier) pour gérer la magie du &ldquo;scale-to-zero&rdquo;. Les deux vont se battre pour le port 80.</p>
<p>Donc, on installe K3s en disant gentiment à Traefik de ne pas venir :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># On installe k3s en désactivant traefik</span>
</span></span><span style="display:flex;"><span>curl -sfL https://get.k3s.io | sh -s - --disable traefik
</span></span></code></pre></div><h3 id="étape-2--installer-knative-serving-le-cerveau">Étape 2 : Installer Knative Serving (Le Cerveau)</h3>
<p>Maintenant qu&rsquo;on a un cluster vide, on installe les deux parties de Knative Serving : les définitions (CRDs) et les contrôleurs (le code).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. Les définitions (pour que K8s comprenne les &#34;ksvc&#34;)</span>
</span></span><span style="display:flex;"><span>kubectl apply -f https://github.com/knative/serving/releases/download/knative-v1.20.0/serving-crds.yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. Le coeur de Knative (Autoscaler, Activator, etc.)</span>
</span></span><span style="display:flex;"><span>kubectl apply -f https://github.com/knative/serving/releases/download/knative-v1.20.0/serving-core.yaml
</span></span></code></pre></div><h3 id="étape-3--installer-kourier-la-porte-dentrée">Étape 3 : Installer Kourier (La Porte d&rsquo;Entrée)</h3>
<p>On installe notre fameux Ingress Kourier, qui va s&rsquo;occuper du réseau.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl apply -f https://github.com/knative-extensions/net-kourier/releases/download/knative-v1.20.0/kourier.yaml
</span></span></code></pre></div><p>Puis, on dit à Knative Serving : &ldquo;Hey, ton Ingress par défaut, c&rsquo;est Kourier !&rdquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl patch configmap/config-network <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --namespace knative-serving <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --type merge <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --patch <span style="color:#e6db74">&#39;{&#34;data&#34;:{&#34;ingress-class&#34;:&#34;kourier.ingress.networking.knative.dev&#34;}}&#39;</span>
</span></span></code></pre></div><h3 id="étape-4--le-dns-magique-sslipio">Étape 4 : Le DNS Magique (sslip.io)</h3>
<p>C&rsquo;est mon astuce préférée pour les &ldquo;home labs&rdquo;. On n&rsquo;a pas de &ldquo;vrai&rdquo; nom de domaine. Donc on va utiliser une astuce que pas grand monde connait (selon moi) !</p>
<p>On va utiliser <code>sslip.io</code>, un service DNS public qui résout une IP&hellip; à partir de l&rsquo;IP elle-même !</p>
<p>Il suffit de dire à Knative : &ldquo;Toutes tes URLs finiront par <code>[MON-IP].sslip.io</code>&rdquo;.</p>
<p>(Remplacez <code>192.168.100.135</code> par l&rsquo;IP de votre nœud K3s)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl patch configmap/config-domain <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --namespace knative-serving <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --type merge <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --patch <span style="color:#e6db74">&#39;{&#34;data&#34;:{&#34;192.168.100.135.sslip.io&#34;:&#34;&#34;}}&#39;</span>
</span></span></code></pre></div><h3 id="étape-5--déployer-">Étape 5 : Déployer !</h3>
<p>C&rsquo;est fini. On n&rsquo;écrit PAS de <code>Deployment</code>, pas de <code>Service</code>, pas d&rsquo;<code>Ingress</code>. On écrit un seul objet : un <code>Service</code> Knative (<code>ksvc</code>).</p>
<p>Créez <code>hello.yaml</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">serving.knative.dev/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">hello</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">image</span>: <span style="color:#ae81ff">gcr.io/knative-samples/helloworld-go</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">env</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">TARGET</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;Blog Knative sur K3s&#34;</span>
</span></span></code></pre></div><p>Appliquez-le :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl apply -f hello.yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ kubectl get ksvc hello
</span></span><span style="display:flex;"><span>NAME    URL                                              LATESTCREATED   LATESTREADY   READY   REASON
</span></span><span style="display:flex;"><span>hello   <span style="color:#f92672">[</span>http://hello.default.192.168.100.135.sslip.io<span style="color:#f92672">](</span>http://hello.default.192.168.100.135.sslip.io<span style="color:#f92672">)</span>    hello-00001     hello-00001   True    
</span></span></code></pre></div><p>Et voilà ! Vous pouvez faire le <code>curl</code> de la démo. Votre propre &ldquo;Cloud Run maison&rdquo; est opérationnel.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Alors, magique ? Pas tout à fait.</p>
<p>Knative, c&rsquo;est &ldquo;juste&rdquo; une chorégraphie hyper intelligente de composants Kubernetes (un Ingress compatible comme Kourier, un Autoscaler, un Activator et des sidecars malins) pour recréer parfaitement l&rsquo;expérience &ldquo;serverless&rdquo; que l&rsquo;on aime chez les grands fournisseurs de Cloud.</p>
<p>C&rsquo;est une technologie incroyable qui démocratise le PaaS (Platform as a Service). On peut <em>vraiment</em> construire notre propre Cloud Run ou AWS Lambda à la maison, ou, comme je suis en train de le faire, pour mon université.</p>
<p>Fini les VM qui tournent à vide à 3h du matin pour notre site de café. L&rsquo;avenir est au &ldquo;scale-to-zero&rdquo;, et grâce à Knative, il est open source et à la portée de tous.</p>
<p>Et vous, prêts à tester ?</p>

        </p>
        
        
            <script
  type="application/javascript"
  src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"
></script>
<script>
  var config = {
    startOnLoad: true,
    theme:'dark',
    align:'center',
  };
  mermaid.initialize(config);
</script>
        
    </div>

    <div class="prev-next">
        
            
                
<div class="prev-post">
    <p>
        <a href="/posts/cyber/twingate/twingate/">
            &#8592;
            :
            Twingate : Le Zero Trust, enfin simplifié
        </a>
    </p>
    <p class="prev-post-date">
        octobre 5, 2025
    </p>
</div>




            
        
    </div>
</div>



    

        </main><footer class="footer">
    
    

    
    <span>&copy; 2025 makhal.fr</span>
    
</footer>
</body>
</html>
